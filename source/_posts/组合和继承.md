---
title: 反对继承
date: 2021-08-13 17:31:56
tags: system design
category: 思考
---
面向对象的父类继承(不包括接口的实现)和组合的对比, 业界已经有统一的共识, 例如:
```
继承是过度设计  --- 许式伟
```
甚至go语言的设计, 干脆就放弃了继承的特性。
而有的程序员, 在开始写代码时, 总是喜欢 "设计" 一番, 教条式抽象出父类来, 然后再用一个子类继承。
而不是写出**简洁**、**直接**的代码, 当父类的方法不满足之后的需求时, 又要在子类中重写父类方法以达到目的......(此处省略2000字)

一年以后, 你会发现他的代码仍然是一个父类, 1到2个子类, 所谓的扩展性设计, 在这份代码生命截止时, 仍然没有派上用场。

## 继承与组合
组合和继承的对比在许多文章、书本里已经讲了很多, 少用继承、多用组合基本在业界已成共识, 这里讲一下自己的理解。
### 世界观
我认为对于继承和组合的理解, 可以上升到世界观维度。试想, 我们想要解决一个规模较大的问题, 一般是通过何种方式？
答案是**分工与协作！** 社会领域如此、计算机的世界也是如此。举个汽车制造的例子：
将汽车拆分以后, 有沙发、轮子、发动机、电机等等组件, 然后组装厂, 将各个零部件**组合**在一起, 便有了一辆汽车。
<img src='/image/car.png' width="50%" height="50%" ></img>
可有**继承**的影子？ 当然, 牛顿有一句话叫"站在巨人的肩膀上"。可是即便是这样, 后人对前人知识和经验的继承也是批判性的继承。
对于编程语言, 继承的语法来说, 其实是**完全**的继承, 你必须重写父类的方法, 才能勉强达到一点**批判性**继承的目的。
说回汽车, 我们已经有了普通的燃油车, 显然, 电动车的发展不是**继承**燃油车的。例如汽油车有加油口, 电动车去继承加油口显然是荒谬的。但这种情况在一些糟糕的程序里却到处可见。

那么又有人说了, 那是因为你设计**汽车**这个父类不够合理, 应该抽象出电动车和燃油车共同的部分, 然后让汽油车和电动车都去继承它, 那么问题来了, 一开始发明燃油车时, 我们并不知道将来会有电动车。又怎么去设计合理的父类呢？

用组合的方式会是怎么样的, 发明燃油车时, 顺便也有了轮子、沙发、燃油机等等。那么在制造电动车时, 我们可以直接把轮子和沙发拿来用, 加上自己的电动机, 便组合出电动车了.

所以我认同"继承是一种过度设计", 继承对解决问题并没有帮助。我们应当思考的方向是分工与协作, 而组合的语法恰恰就是**分工与协作**思想的体现。
对于分工, 即什么样的任务归谁负责的问题。在程序设计里对应**单一职责原则**。
对于协作。在程序设计里则对应**接口设计**, 我们需要思考清楚, 程序与程序之间、人与程序之间的界面应该是如何的。

### 程序设计糟糕在往往在后期才能付出代价
但是, 由于程序的改动相对是低成本的, 经常就会做出违反原则的事情了来。没有清晰的模块间分工与协作, 经常就是轮胎做了发动机的事情。例如有人做出了可以自己跑的轮胎。
这在汽车生产行业是非常荒谬的, 但在程序设计里却经常发生(或者说没有设计, 只是想快速完成功能)。随着时间的推移, 系统往往也就变的一团糟, 无法维护, 只能重写了。

## 总结
在计算机编程中, 组合是对**分工与协作**思想的体现。
程序设计要简单直接, 不要自作聪明。
继承是一种过度设计。